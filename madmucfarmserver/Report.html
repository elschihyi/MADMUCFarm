<!DOCTYPE html>
{% autoescape true %}
<html>
    <head>
    <META HTTP-EQUIV="Pragma" CONTENT="no-cache">
    <META HTTP-EQUIV="Expires" CONTENT="-1">
    <script>
        function write_to_excel() {
            str = "";
            var bintable = document.getElementsByID("bintable")[0];
            var rowCount = mytable.rows.length;
            var colCount = mytable.getElementsByTagName("tr")[0].getElementsByTagName("td").length;
            
            var ExcelApp = new ActiveXObject("Excel.Application");
            var ExcelSheet = new ActiveXObject("Excel.Sheet");
            ExcelSheet.Application.Visible = true;
            
            for (var i = 0; i < rowCount; i++) {
                for (var j = 0; j < colCount; j++) {
                    str = mytable.getElementsByTagName("tr")[i].getElementsByTagName("td")[j].innerHTML;
                    ExcelSheet.ActiveSheet.Cells(i + 1, j + 1).Value = str;
                }
            }
        }
    </script>
    </head>
    <body>
        <font size="6">Bin</font><br>
        <table border="1" id="bintable">
            <tr><td>Bin #</td><td>Bin Size</td><td>Bushel</td><td>Crop Kind</td><td>% Moister</td><tr>
            {% for bin in bins %}
            <tr><td>{{bin.binID}}</td><td>{{bin.binSize}}</td><td>{{bin.bushel}}</td><td>{{bin.crop}}</td><td>{{bin.moister}}</td></tr>
            {% endfor %}
        </table>
        <button onclick="write_to_excel()">Try it</button>
        <form action="/operations" method="post">
            <input type="hidden" name="token" value="{{token}}">
            <input type="submit" value="Back">
        </form>
        <br>
        <form action="/logout" method="get">
            <input type="hidden" name="token" value="{{token}}">
            <input type="submit" value="Logout">
        </form>
    </body>
</html>
{% endautoescape %}